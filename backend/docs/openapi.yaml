openapi: 3.0.0

info:
  title: SprintDesk API
  description: |
    SprintDesk is a multi-tenant SaaS backend for project and task management.
    All APIs are workspace-scoped and secured via JWT.
  version: 1.0.0

servers:
  - url: http://localhost:5000
    description: Local development

tags:
  - name: Auth
    description: Authentication & authorization
  - name: Workspaces
    description: Workspace (tenant) management
  - name: Projects
    description: Project management
  - name: Tasks
    description: Task management

security:
  - bearerAuth: []

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    User:
      type: object
      properties:
        _id:
          type: string
        name:
          type: string
        email:
          type: string

    Workspace:
      type: object
      properties:
        _id:
          type: string
        name:
          type: string
        description:
          type: string
        inviteCode:
          type: string

    Project:
      type: object
      properties:
        _id:
          type: string
        name:
          type: string
        emoji:
          type: string
        description:
          type: string

    Task:
      type: object
      properties:
        _id:
          type: string
        title:
          type: string
        status:
          type: string
        priority:
          type: string

    ErrorResponse:
      type: object
      properties:
        errorCode:
          type: string
        message:
          type: string

paths:
  /api/auth/register:
    post:
      tags: [Auth]
      summary: Register a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                name:
                  type: string
                email:
                  type: string
                password:
                  type: string
      responses:
        201:
          description: User registered

  /api/auth/login:
    post:
      tags: [Auth]
      summary: Login user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        200:
          description: Login successful

  /api/workspaces:
    post:
      tags: [Workspaces]
      summary: Create a workspace
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                description:
                  type: string
      responses:
        201:
          description: Workspace created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Workspace"

  /api/projects:
    post:
      tags: [Projects]
      summary: Create project
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                emoji:
                  type: string
                description:
                  type: string
      responses:
        201:
          description: Project created

    get:
      tags: [Projects]
      summary: List projects
      responses:
        200:
          description: List of projects

  /api/tasks:
    post:
      tags: [Tasks]
      summary: Create task
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, projectId]
              properties:
                title:
                  type: string
                projectId:
                  type: string
                priority:
                  type: string
                dueDate:
                  type: string
                  format: date
      responses:
        201:
          description: Task created

  /api/tasks/{projectId}:
    get:
      tags: [Tasks]
      summary: List tasks by project
      parameters:
        - in: path
          name: projectId
          required: true
          schema:
            type: string
      responses:
        200:
          description: List of tasks
